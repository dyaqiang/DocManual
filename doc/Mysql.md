##### 索引





##### 执行流程

* 连接器

  简单理解就是链接数据库，权限鉴定，TCP链接，等

* 查询缓存

  执行过的语句会进行缓存，所以会优先进行缓存的执行查询，一般不用 常用的就是那种更新很少，但是查询次数多的表

* 分析器

  s q l 语句的语法分析，我要怎么执行s q l 语句进行查询呢

* 优化器

  优化什么呢？用那个索引，执行顺序，条件很多，先执行那个表，再关联那个表进行查询

* 执行器

  一行行的开始执行代码了

* 引擎

##### 调优



##### 数据库的范式设计

* 每个属性不可再分，每个列不可再分

* 所有列必须依赖主建 和主键有关

* 不能存在传递依赖函数

  这个东西很虚～ 实际设计中很少能完美的契合



##### 存储引擎

###### Innodb

1. 支持事物
2. MVCC 来支持高并发，实现了四个标准隔离级别(未提交读、提交读、可重复读、可串行化)。其默认级别时可重复读（REPEATABLE READ），在可重复读级别下，通过 MVCC + Next-Key Locking 防止幻读
3. 主索引时聚簇索引，在索引中保存了数据，从而避免直接读取磁盘，因此对主键查询有很高的性能
4. InnoDB 内部做了很多优化，包括从磁盘读取数据时采用的可预测性读，能够自动在内存中创建 hash 索引以加速读操作的自适应哈希索引，以及能够加速插入操作的插入缓冲区等
5. InnoDB 支持真正的在线热备份，MySQL 其他的存储引擎不支持在线热备份，要获取一致性视图需要停止对所有表的写入，而在读写混合的场景中，停止写入可能也意味着停止读取

###### Myisam

1. 不支持事务
2. 不支持行级锁，只能对整张表加锁，读取时会对需要读到的所有表加共享锁，写入时则对表加排它锁。但在表有读取操作的同时，也可以往表中插入新的记录，这被称为并发插入（CONCURRENT INSERT）

######  InnoDB 和 MyISAM 的比较

- 事务：InnoDB 是事务型的，可以使用 Commit 和 Rollback 语句。
- 并发：MyISAM 只支持表级锁，而 InnoDB 还支持行级锁。
- 外键：InnoDB 支持外键。
- 备份：InnoDB 支持在线热备份。
- 崩溃恢复：MyISAM 崩溃后发生损坏的概率比 InnoDB 高很多，而且恢复的速度也更慢。
- 其它特性：MyISAM 支持压缩表和空间数据索引。

